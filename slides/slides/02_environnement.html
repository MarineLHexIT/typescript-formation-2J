<section>
    <h1 class="r-fit-text">Environnement et outillage</h1>
    <aside class="notes">Passons maintenant à la configuration pratique. Nous allons installer Node.JS,
        configurer un projet, et aborder l’intégration côté serveur.
    </aside>
    <ul>
        <li class="fragment">Installer Node.JS et Typescript</li>
        <li class="fragment">Intégration dans les IDE</li>
        <li class="fragment">Intégrer Typescript dans des projets existants</li>
        <li class="fragment">Ajouter Typescript côté serveur</li>
    </ul>
</section>

<section>
    <h2>Installer Node.js</h2>
    <ul>
        <li class="fragment">
            <strong>Prérequis : </strong> Node.js pour exécuter du JS ou du TS sur votre machine.
        </li>
        <li class="fragment">
            <strong>Installer Node.js</strong>
            <ul>
                <li class="fragment">
                    Rendez-vous sur <a href="https://nodejs.org">nodejs.org</a> et téléchargez la version LTS
                    (Long Term Support) et suivez les instructions
                </li>
                <li class="fragment">
                    Vérifiez l’installation :
                    <pre>
                                <code data-trim data-noescape class="hljs language-bash">
                                    node --version
                                    npm --version
                                </code>
                            </pre>
                </li>
            </ul>
        </li>
    </ul>
    <aside class="notes">
        Si Node.js n’est pas déjà installé sur votre machine, vous devez d’abord l’installer. Node.js est
        essentiel pour exécuter votre code TypeScript, et npm (le gestionnaire de paquets) sera utilisé pour
        installer TypeScript et d’autres dépendances.
    </aside>
</section>

<section>
    <h2>Installation de Typescript</h2>
    <ul>
        <li class="fragment">
            <strong>Créer un projet</strong>
            <ul>
                <li>Créer un dossier et s’y placer</li>
                <li>
                    Dans un terminal :
                    <pre>
                                <code data-trim data-noescape class="hljs language-bash">
                                    npm init // initialise le dossier
                                </code>
                            </pre>
                </li>
            </ul>
        </li>
        <li class="fragment">
            <strong>Installer Typescript localement</strong>
            <pre>
                        <code data-trim data-noescape class="hljs language-bash">
                            npm install -D typescript
                            npx tsc --version // Vérifie que l’installation s’est bien passé
                        </code>
                    </pre>
        </li>
        <li class="fragment">
            <strong>Initialiser un projet Typescript</strong>
            <pre>
                        <code data-trim data-noescape class="hljs language-bash">
                            npx tsc --init
                        </code>
                    </pre>
        </li>

    </ul>

    <aside class="notes">
        Une fois Node.js installé, nous allons commencer à créer notre projet.
        Il est possible d’installer Typescript globalement ou localement.
        Nous allons l’installer localement, au sein d’un projet.
    </aside>
</section>

<section>
    <h2>Les IDE au service de Typescript</h2>
    <ul>
        <li class="fragment">
            <strong>IDE populaires</strong>
            <ul>
                <li>Visual Studio Code (VS Code) : léger, gratuit, et extensible</li>
                <li>Webstorm : puissant, riche en fonctionnalité, payant</li>
            </ul>
        </li>
        <li class="fragment">
            <strong>Alternatives</strong>
            <ul>
                <li>Sublime Text : nécessite des plugins</li>
                <li>Vim / NéoVim : nécessite une configuration avancée</li>
                <li>Notepad++ : compatible mais dispose de peu de fonctionnalités</li>
            </ul>
        </li>
    </ul>
    <aside class="notes">
        Bien que Typescript soit compatible avec la plupart des éditeurs de textes et environnements de
        développement, certains offrent une meilleure prise en charge, notamment grâce à l’auto-complétion et à
        la détection d’erreur en temps réel.
        Personnellement j’utilise Webstorm mais on va aussi regarder du côté de Visual Studio Code.
    </aside>
</section>

<section data-markdown>
            <textarea data-template>
## Configurer Visual Studio Code pour Typescript 1/2

1. **Étape 1 : Installer VS Code**
    - Téléchargez depuis [code.visualstudio.com](https://code.visualstudio.com).

2. **Étape 2 : Installer les extensions nécessaires**
    - **TypeScript and JavaScript Language Features** (intégré).
    - **ESLint** (si vous utilisez un linter).

Note:
Visual Studio Code est extrêmement bien intégré avec TypeScript. L’installation de base suffit pour démarrer, mais des extensions comme ESLint ou Prettier peuvent améliorer encore votre expérience.

---
## Configurer Visual Studio Code pour Typescript 2/2

3. **Étape 3 : Personnaliser `settings.json` (optionnel)**
    - Exemple de configuration :
    ```json
    {
    "typescript.tsdk": "./node_modules/typescript/lib",
    "editor.formatOnSave": true,
    "eslint.validate": ["javascript", "typescript"]
    }
    ```
4. **Étape 4 : Activer le mode de vérification stricte dans `tsconfig.json`**
    - Ajoutez `"strict": true` dans votre configuration.
        </textarea>
</section>

<section>
    <h2>Typescript côté client</h2>
    <aside class="notes">
        Nos navigateurs n’interprètent pas Typescript directement : vous devrez toujours le compiler en Javascript et donc intégrer un fichier .js dans votre HTML.
        Avec les frameworks comme React, Angular ou Vue, la configuration et compilation se font automatiquement.
        Sur des petits projets, vous pouvez utiliser des outils comme esbuild ou vite pour une compilation en temps réel.
    </aside>

    <div class="flex flex-col gap-5">
        <figure>
            <figcaption class="text-left">1. fichier main.ts</figcaption>

            <pre class="w-full">
                        <code data-trim data-noescape class="typescript" data-line-numbers="" data-fragment-index="0">
                            <script type="text/template">
                            document.addEventListener('DOMContentLoaded', async () => {
                            const title:HTMLElement = document.querySelector('#title');
                            title.innerHTML = "Hello World";
                            });
                            </script>
                        </code>

                    </pre>
        </figure>


        <figure>
            <figcaption class="text-left">2. compiler le projet</figcaption>
            <pre class="w-full">
                        <code data-trim data-noescape class="bash" data-fragment-index="0">
                            npm tsc
                        </code>
                    </pre>
        </figure>

        <figure>
            <figcaption class="text-left">3 import du fichier .js dans le HTML</figcaption>
            <pre class="w-full">
                        <code data-trim data-noescape class="html" data-line-numbers="" data-fragment-index="0">
                            &lt;!DOCTYPE html&gt;
                                &lt;html lang=&quot;en&quot;&gt;
                                &lt;head&gt;
                                  &lt;meta charset=&quot;UTF-8&quot;&gt;
                                  &lt;title&gt;TypeScript dans le navigateur&lt;/title&gt;
                                &lt;/head&gt;
                                &lt;body&gt;
                                  &lt;script src=&quot;main.js&quot;&gt;&lt;/script&gt;
                                &lt;/body&gt;
                            &lt;/html&gt;
                        </code>
                    </pre>
        </figure>
    </div>

</section>

<section>
    <h2>Les avantages de Typescript côté serveur</h2>
    <ul>
        <li class="fragment">
            <strong>Meilleure maintenabilité : </strong>
            Systèmes complexes mieux structurés grâce aux types
        </li>
        <li class="fragment">
            <strong>Moins d’erreurs : </strong>
            Détection des erreurs au moment du développement.
        </li>
        <li class="fragment">
            <strong>Écosystème riche : </strong>
            Support étendu dans des frameworks comme Express, NestJS, etc.
        </li>
        <li class="fragment">
            <strong>Interopérabilité facile : </strong>
            Compatible avec tout Javascript et Node.js
        </li>
    </ul>
    <aside class="notes">
        Les avantages de Typescript que nous avons vus s’appliquent tout à fait côté serveur.
    </aside>
</section>

<section data-markdown>
            <textarea data-template>
## Configurer un serveur Node.js avec Typescript (1/4)

- **Étape 1 : Initialiser un projet Node.js**
    - Commande pour créer un nouveau projet :
      ```bash
      npm init -y
      ```
    - Installez TypeScript et ses dépendances :
      ```bash
      npm install typescript ts-node @types/node --save-dev
      ```

---
## Configurer un serveur Node.js avec Typescript (2/4)

- **Étape 2 : Configurer `tsconfig.json`**
    - Commande pour générer un fichier de configuration :
      ```bash
      npx tsc --init
      ```
    - Exemple de fichier :
      ```json
      {
        "compilerOptions": {
          "target": "ES2020", // La version de JavaScript ciblée après compilation
          "module": "commonjs", // Le système de modules utilisé, ici pour Node.js
          "outDir": "./dist", // Le dossier où seront placés les fichiers compilés
          "rootDir": "./src", // Le dossier racine contenant le code source TypeScript
          "strict": true, // Active un ensemble de vérifications strictes (recommandé)
          "esModuleInterop": true // Permet une meilleure interopérabilité avec les modules CommonJS
        }
      }
      ```

Note:
Le fichier `tsconfig.json` est essentiel pour adapter le compilateur TypeScript à votre projet. Configurez-le selon vos besoins, notamment pour définir où les fichiers compilés seront placés.
---
## Configurer un serveur Node.js avec Typescript (3/4)


- **Étape 3 : Créer un fichier de démarrage**
    - Exemple : `src/server.ts`
      ```typescript
      import express from 'express'; // Import de la bibliothèque Express

      const app = express(); // Création d'une application Express
      const port = 3000; // Port d'écoute du serveur

      // Route GET qui renvoie un message simple
      app.get('/', (req, res) => {
        res.send('Hello, TypeScript!');
      });

      // Démarrage du serveur avec une fonction de callback
      app.listen(port, () => {
        console.log(`Server is running on http://localhost:${port}`);
      });
      ```
    - Installer les dépendances
    ```bash
    npm install express
    npm install --save-dev @types/express
    ```
---
## Configurer un serveur Node.js avec Typescript (4/4)

- **Étape 4 : Lancer le serveur**
    - Utilisez `ts-node` pour démarrer directement en TypeScript :
      ```bash
      npx ts-node src/server.ts
      ```
    - Compilez puis exécutez en JavaScript si nécessaire :
      ```bash
      npx tsc && node dist/server.js
      ```

Notes:
Voici un serveur minimal utilisant TypeScript avec Express. En plus de renforcer la robustesse de votre projet, cette configuration est facilement extensible pour des cas d’usage plus complexes.
            </textarea>
</section>
<section>
    <h2>Déboguer comme un pro avec les Source Map</h2>
    <ul>
        <li class="fragment">
            <strong>Qu’est-ce qu’un Source Map ?</strong>
            <ul>
                <li>
                    Fichier généré lors de la compilation Typescript vers Javascript
                </li>
                <li>
                    Permet de relier le code Javascript compilé au code Typescript d’origine
                </li>
            </ul>
        </li>
        <li class="fragment">
            <strong>Activation : </strong>
            <ul>
                <li>
                    Ajouter dans <code>tsconfig.json</code>
                    <pre>
                                <code data-trim data-noescape class="json language-json">
                                {
                                    "sourceMap": true
                                }
                                </code>
                            </pre>
                </li>
            </ul>
        </li>
    </ul>
    <aside class="notes">
        Les Source Maps sont des fichiers magiques qui vous permettent de déboguer votre code TypeScript
        directement, même après compilation. Ils font le lien entre le JavaScript exécuté et le code TypeScript
        original. Pour les activer, ajoutez simplement `sourceMap: true` dans votre configuration.
    </aside>
</section>
<section>
    <h2>Avantage du Source Map</h2>
    <ul>
        <li>Debugger directement le code Typescript dans les navigateurs ou outils comme VS Code.</li>
    </ul>
    <div class="flex flex-row gap-5 items-baseline">
        <figure class="w-1/2">
            <img src="images/console_js.png" alt="" style="margin: 0 auto;"/>
            <figcaption>
                Aperçu du code JS dans le navigateur
            </figcaption>
        </figure>
        <figure class="w-1/2">
            <img src="images/console_ts.png" alt="" style="margin: 0 auto;"/>
            <figcaption>
                Aperçu du code Typescript dans le navigateur
            </figcaption>
        </figure>
    </div>
    <aside class="notes">
        Le Source Map va permettre au navigateur de connaître votre code Typescript et vous guider plus facilement en cas d’erreur.

        Quelle(s) différence(s) voyez-vous dans les aperçus ?
    </aside>
</section>
<section>
    <h2>Atelier</h2>
    <p class="r-fix-text">
        À partir de ce que l’on vient de voir, mettre en place des dossiers de travail pour Typescript.
    </p>
    <ul>
        <li>
            Initialiser avec <code>npm</code> puis installer <strong>typescript</strong>
        </li>
        <li>
            Initialiser avec <code>tsc</code>
        </li>
        <li>
            Configurer vos fichiers <code>package.json</code> et <code>tsconfig.json</code>
        </li>
    </ul>
</section>

<section>
    <h2>Environnement et outillage : récapitulatif</h2>
    <ul>
        <li>
            Typescript : facile à installer avec <code>npm</code>
        </li>
        <li>
            <code>tsconfig.json</code> : le cœur de la configuration
        </li>
        <li>
            IDE modernes compatibles et pourvus de fonctionnalités pour aider à l’écriture de code Typescript
        </li>
        <li>
            Les Sources Map : outils indispensables pour le débogage.
        </li>
    </ul>
    <aside class="notes">
        Pour résumer, TypeScript est simple à configurer et bénéficie d’outils modernes pour rendre le développement agréable. Avec une configuration solide et un bon IDE, vous êtes prêts à écrire du code TypeScript comme des pros.
    </aside>
</section>